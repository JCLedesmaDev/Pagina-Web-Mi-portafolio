{"ast":null,"code":"import _asyncToGenerator from\"D:\\\\Juanchi\\\\Programacion\\\\Practicas realizadas\\\\01-02-22 React y TypeScript - React-portafolio-pwa\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _slicedToArray from\"D:\\\\Juanchi\\\\Programacion\\\\Practicas realizadas\\\\01-02-22 React y TypeScript - React-portafolio-pwa\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"D:\\\\Juanchi\\\\Programacion\\\\Practicas realizadas\\\\01-02-22 React y TypeScript - React-portafolio-pwa\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{useCallback,useEffect,useMemo,useState}from\"react\";/// Capta si tenemos la PWA instalada.\nvar isInWebApp=window.matchMedia(\"(display-mode: standalone)\").matches;export function useAddToHomeScreenPrompt(){/* CODIGO SACADO DE: https://www.youtube.com/watch?v=3f20qBfACzI\r\n   No entendi su funcionamiento pero anda.\r\n  \r\n    Practicamente lo que hace es: Si al ingresar a la pagina, no tenes \r\n    la app instalada, te aparece una ventanita para isntalar\r\n    caso contrario, si lo tenes instalado, no te aparece nada.\r\n  */var _useState=useState(null),_useState2=_slicedToArray(_useState,2),prompt=_useState2[0],setPrompt=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isReady=_useState4[0],setIsReady=_useState4[1];var _useState5=useState(isInWebApp),_useState6=_slicedToArray(_useState5,2),finishInstallation=_useState6[0],setFinishInstallation=_useState6[1];// Hace aparecer la ventana para isntalar\nvar promptToInstall=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var choiceResult;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!prompt){_context.next=7;break;}prompt.prompt();_context.next=4;return prompt.userChoice;case 4:choiceResult=_context.sent;if(choiceResult.outcome===\"accepted\")setFinishInstallation(true);return _context.abrupt(\"return\");case 7:return _context.abrupt(\"return\",Promise.reject(new Error('Tried installing before browser sent \"beforeinstallprompt\" event')));case 8:case\"end\":return _context.stop();}}},_callee);})),[prompt]);useEffect(function(){if(prompt)setIsReady(true);},[prompt]);function ready(e){e.preventDefault();setPrompt(e);}useEffect(function(){window.addEventListener(\"beforeinstallprompt\",ready);return function(){window.removeEventListener(\"beforeinstallprompt\",ready);};},[]);return useMemo(function(){return{isReady:isReady,promptToInstall:promptToInstall,finishInstallation:finishInstallation};},[isReady,promptToInstall,finishInstallation]);}","map":{"version":3,"sources":["D:/Juanchi/Programacion/Practicas realizadas/01-02-22 React y TypeScript - React-portafolio-pwa/src/Hooks/useAddToHomeScreenPrompt.tsx"],"names":["useCallback","useEffect","useMemo","useState","isInWebApp","window","matchMedia","matches","useAddToHomeScreenPrompt","prompt","setPrompt","isReady","setIsReady","finishInstallation","setFinishInstallation","promptToInstall","userChoice","choiceResult","outcome","Promise","reject","Error","ready","e","preventDefault","addEventListener","removeEventListener"],"mappings":"+jBAAA,OAASA,WAAT,CAAsBC,SAAtB,CAAiCC,OAAjC,CAA0CC,QAA1C,KAA0D,OAA1D,CAUA;AACA,GAAMC,CAAAA,UAAU,CAAGC,MAAM,CAACC,UAAP,CAAkB,4BAAlB,EAAgDC,OAAnE,CAEA,MAAO,SAASC,CAAAA,wBAAT,EAAoC,CACzC;AACF;AACA;AACA;AACA;AACA;AACA,IAEE,cAA4BL,QAAQ,CAAmC,IAAnC,CAApC,wCAAOM,MAAP,eAAeC,SAAf,eACA,eAA8BP,QAAQ,CAAC,KAAD,CAAtC,yCAAOQ,OAAP,eAAgBC,UAAhB,eACA,eAAoDT,QAAQ,CAACC,UAAD,CAA5D,yCAAOS,kBAAP,eAA2BC,qBAA3B,eAEA;AACA,GAAMC,CAAAA,eAAe,CAAGf,WAAW,sEAAC,wJAC9BS,MAD8B,yBAEhCA,MAAM,CAACA,MAAP,GAFgC,sBAILA,CAAAA,MAAM,CAACO,UAJF,QAI1BC,YAJ0B,eAKhC,GAAIA,YAAY,CAACC,OAAb,GAAyB,UAA7B,CAAyCJ,qBAAqB,CAAC,IAAD,CAArB,CALT,wEAU3BK,OAAO,CAACC,MAAR,CACL,GAAIC,CAAAA,KAAJ,CACE,kEADF,CADK,CAV2B,wDAAD,GAehC,CAACZ,MAAD,CAfgC,CAAnC,CAiBAR,SAAS,CAAC,UAAM,CACd,GAAIQ,MAAJ,CAAYG,UAAU,CAAC,IAAD,CAAV,CACb,CAFQ,CAEN,CAACH,MAAD,CAFM,CAAT,CAIA,QAASa,CAAAA,KAAT,CAAeC,CAAf,CAA6C,CAC3CA,CAAC,CAACC,cAAF,GACAd,SAAS,CAACa,CAAD,CAAT,CACD,CAEDtB,SAAS,CAAC,UAAM,CACdI,MAAM,CAACoB,gBAAP,CAAwB,qBAAxB,CAA+CH,KAA/C,EAEA,MAAO,WAAY,CACjBjB,MAAM,CAACqB,mBAAP,CAA2B,qBAA3B,CAAkDJ,KAAlD,EACD,CAFD,CAGD,CANQ,CAMN,EANM,CAAT,CAQA,MAAOpB,CAAAA,OAAO,CACZ,iBAAO,CACLS,OAAO,CAAPA,OADK,CAELI,eAAe,CAAfA,eAFK,CAGLF,kBAAkB,CAAlBA,kBAHK,CAAP,EADY,CAMZ,CAACF,OAAD,CAAUI,eAAV,CAA2BF,kBAA3B,CANY,CAAd,CAQD","sourcesContent":["import { useCallback, useEffect, useMemo, useState } from \"react\";\r\n\r\ninterface IBeforeInstallPromptEvent extends Event {\r\n  readonly platforms: string[];\r\n  readonly userChoice: Promise<{\r\n    outcome: \"accepted\" | \"dismissed\";\r\n    platform: string;\r\n  }>;\r\n  prompt(): Promise<void>;\r\n}\r\n/// Capta si tenemos la PWA instalada.\r\nconst isInWebApp = window.matchMedia(\"(display-mode: standalone)\").matches;\r\n\r\nexport function useAddToHomeScreenPrompt() {\r\n  /* CODIGO SACADO DE: https://www.youtube.com/watch?v=3f20qBfACzI\r\n   No entendi su funcionamiento pero anda.\r\n  \r\n    Practicamente lo que hace es: Si al ingresar a la pagina, no tenes \r\n    la app instalada, te aparece una ventanita para isntalar\r\n    caso contrario, si lo tenes instalado, no te aparece nada.\r\n  */\r\n\r\n  const [prompt, setPrompt] = useState<IBeforeInstallPromptEvent | null>(null);\r\n  const [isReady, setIsReady] = useState(false);\r\n  const [finishInstallation, setFinishInstallation] = useState(isInWebApp);\r\n\r\n  // Hace aparecer la ventana para isntalar\r\n  const promptToInstall = useCallback(async () => {\r\n    if (prompt) {\r\n      prompt.prompt();\r\n\r\n      const choiceResult = await prompt.userChoice;\r\n      if (choiceResult.outcome === \"accepted\") setFinishInstallation(true);\r\n\r\n      return;\r\n    }\r\n\r\n    return Promise.reject(\r\n      new Error(\r\n        'Tried installing before browser sent \"beforeinstallprompt\" event'\r\n      )\r\n    );\r\n  }, [prompt]);\r\n\r\n  useEffect(() => {\r\n    if (prompt) setIsReady(true);\r\n  }, [prompt]);\r\n\r\n  function ready(e: IBeforeInstallPromptEvent) {\r\n    e.preventDefault();\r\n    setPrompt(e);\r\n  }\r\n\r\n  useEffect(() => {\r\n    window.addEventListener(\"beforeinstallprompt\", ready as any);\r\n\r\n    return function () {\r\n      window.removeEventListener(\"beforeinstallprompt\", ready as any);\r\n    };\r\n  }, []);\r\n\r\n  return useMemo(\r\n    () => ({\r\n      isReady,\r\n      promptToInstall,\r\n      finishInstallation,\r\n    }),\r\n    [isReady, promptToInstall, finishInstallation]\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}